# paup vs anagallis
patd1 <- treedist(paup1,ana1)
patd2 <- treedist(paup2,ana2)
patd3 <- treedist(paup3,ana3)
patd4 <- treedist(paup4,ana4)
patd5 <- treedist(paup5,ana5)
patd6 <- treedist(paup6,ana6)
patd7 <- treedist(paup7,ana7)
patd8 <- treedist(paup8,ana8)
patd9 <- treedist(paup9,ana9)
patd10 <- treedist(paup10,ana10)
patd <- rbind(patd1,patd2,patd3,patd4,patd5,patd6,patd7,patd8,patd9,patd10)
patdmean <- apply(patd, 2, mean)
# morphy vs anagallis
matd1 <- treedist(morphy,ana1)
matd2 <- treedist(morphy,ana2)
matd3 <- treedist(morphy,ana3)
matd4 <- treedist(morphy,ana4)
matd5 <- treedist(morphy,ana5)
matd6 <- treedist(morphy,ana6)
matd7 <- treedist(morphy,ana7)
matd8 <- treedist(morphy,ana8)
matd9 <- treedist(morphy,ana9)
matd10 <- treedist(morphy,ana10)
matd <- rbind(matd1,matd2,matd3,matd4,matd5,matd6,matd7,matd8,matd9,matd10)
matdmean <- apply(matd, 2, mean)
treedist <- rbind(pmtdmean, patdmean, matdmean)
colnames(treedist) <- c("Symmetric distance", "Path difference")
rownames(treedist) <- c("Paup vs Morphy", "Paup vs Anagallis", "Morphy vs Anagallis")
AH2006 <- as.data.frame(treedist)
#### SPR #### requires resolved trees
# paup vs morphy
pmspr1 <- SPR.dist(paup1,morphy)
pmspr2 <- SPR.dist(paup2,morphy)
pmspr3 <- SPR.dist(paup3,morphy)
pmspr4 <- SPR.dist(paup4,morphy)
pmspr5 <- SPR.dist(paup5,morphy)
pmspr6 <- SPR.dist(paup6,morphy)
pmspr7 <- SPR.dist(paup7,morphy)
pmspr8 <- SPR.dist(paup8,morphy)
pmspr9 <- SPR.dist(paup9,morphy)
pmspr10 <- SPR.dist(paup10,morphy)
pmspr <- c(pmspr1,pmspr2,pmspr3,pmspr4,pmspr5,pmspr6,pmspr7,pmspr8,pmspr9,pmspr10)
pmspr <- mean(pmspr)
# paup vs anagallis
paspr1 <- SPR.dist(paup1,ana1)
paspr2 <- SPR.dist(paup2,ana2)
paspr3 <- SPR.dist(paup3,ana3)
paspr4 <- SPR.dist(paup4,ana4)
paspr5 <- SPR.dist(paup5,ana5)
paspr6 <- SPR.dist(paup6,ana6)
paspr7 <- SPR.dist(paup7,ana7)
paspr8 <- SPR.dist(paup8,ana8)
paspr9 <- SPR.dist(paup9,ana9)
paspr10 <- SPR.dist(paup10,ana10)
paspr <- c(paspr1,paspr2,paspr3,paspr4,paspr5,paspr6,paspr7,paspr8,paspr9,paspr10)
paspr <- mean(paspr)
# morphy vs anagallis
maspr1 <- SPR.dist(morphy,ana1)
maspr2 <- SPR.dist(morphy,ana2)
maspr3 <- SPR.dist(morphy,ana3)
maspr4 <- SPR.dist(morphy,ana4)
maspr5 <- SPR.dist(morphy,ana5)
maspr6 <- SPR.dist(morphy,ana6)
maspr7 <- SPR.dist(morphy,ana7)
maspr8 <- SPR.dist(morphy,ana8)
maspr9 <- SPR.dist(morphy,ana9)
maspr10 <- SPR.dist(morphy,ana10)
maspr <- c(maspr1,maspr2,maspr3,maspr4,maspr5,maspr6,maspr7,maspr8,maspr9,maspr10)
maspr <- mean(maspr)
spr <- c(pmspr, paspr, maspr)
AH2006$'Subtree pruning and regrafting' <- c(spr)
#### path difference #### probably requires resolved trees
# paup vs morphy
pmpd1 <- path.dist(paup1,morphy)
pmpd2 <- path.dist(paup2,morphy)
pmpd3 <- path.dist(paup3,morphy)
pmpd4 <- path.dist(paup4,morphy)
pmpd5 <- path.dist(paup5,morphy)
pmpd6 <- path.dist(paup6,morphy)
pmpd7 <- path.dist(paup7,morphy)
pmpd8 <- path.dist(paup8,morphy)
pmpd9 <- path.dist(paup9,morphy)
pmpd10 <- path.dist(paup10,morphy)
pmpd <- c(pmpd1,pmpd2,pmpd3,pmpd4,pmpd5,pmpd6,pmpd7,pmpd8,pmpd9,pmpd10)
pmpd <- mean(pmpd)
# paup vs anagallis
papd1 <- path.dist(paup1,ana1)
papd2 <- path.dist(paup2,ana2)
papd3 <- path.dist(paup3,ana3)
papd4 <- path.dist(paup4,ana4)
papd5 <- path.dist(paup5,ana5)
papd6 <- path.dist(paup6,ana6)
papd7 <- path.dist(paup7,ana7)
papd8 <- path.dist(paup8,ana8)
papd9 <- path.dist(paup9,ana9)
papd10 <- path.dist(paup10,ana10)
papd <- c(papd1,papd2,papd3,papd4,papd5,papd6,papd7,papd8,papd9,papd10)
papd <- mean(papd)
# morphy vs anagallis
mapd1 <- path.dist(morphy,ana1)
mapd2 <- path.dist(morphy,ana2)
mapd3 <- path.dist(morphy,ana3)
mapd4 <- path.dist(morphy,ana4)
mapd5 <- path.dist(morphy,ana5)
mapd6 <- path.dist(morphy,ana6)
mapd7 <- path.dist(morphy,ana7)
mapd8 <- path.dist(morphy,ana8)
mapd9 <- path.dist(morphy,ana9)
mapd10 <- path.dist(morphy,ana10)
mapd <- c(mapd1,mapd2,mapd3,mapd4,mapd5,mapd6,mapd7,mapd8,mapd9,mapd10)
mapd <- mean(mapd)
pathdist <- c(pmpd, papd, mapd)
AH2006$'Path distance' <- c(pathdist)
AH2006$'Robinson-Foulds distance' <- c(rf)
View(AH2006)
save_kable(kable(AH2006, format = "html"), file = "TreeDistanceA&H2006.html")
setwd("~/Documents/Imperial/Morphological Character Hierarchies/Data/Atkinson, 2019/")
library(ape)
library(distory)
library(phangorn)
library(phytools)
library(paleotree)
library(tibble)
library(knitr)
library(Quartet)
library(kableExtra)
# paup
paup <- read.nexus("")
# paup
paup <- read.nexus("Paup-A2019.tre")
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
setwd("~/Documents/Imperial/Morphological Character Hierarchies/Data/Atkinson, 2019/")
library(ape)
library(distory)
library(phangorn)
library(phytools)
library(paleotree)
library(tibble)
library(knitr)
library(Quartet)
library(kableExtra)
# paup
paup <- read.nexus("Paup-A2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
morphy <- consensus(morphy)
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
treelist <- c(paup, morphy)
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
View(morphy)
View(paup)
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
treelist <- c(paup, morphy)
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
# paup
paup <- read.nexus("Paup-A2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphy-A2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
treelist <- c(paup, morphy)
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
#### basic comparison ####
comparePhylo(paup, morphy)
phylo.diff(paup, morphy, type = "cladogram")
#### resolve trees ####
is.binary(paup)
is.binary(morphy)
paup1 <- multi2di(paup)
paup2 <- multi2di(paup)
paup3 <- multi2di(paup)
paup4 <- multi2di(paup)
paup5 <- multi2di(paup)
paup6 <- multi2di(paup)
paup7 <- multi2di(paup)
paup8 <- multi2di(paup)
paup9 <- multi2di(paup)
paup10 <- multi2di(paup)
morphy1 <- multi2di(morphy)
morphy2 <- multi2di(morphy)
morphy3 <- multi2di(morphy)
morphy4 <- multi2di(morphy)
morphy5 <- multi2di(morphy)
morphy6 <- multi2di(morphy)
morphy7 <- multi2di(morphy)
morphy8 <- multi2di(morphy)
morphy9 <- multi2di(morphy)
morphy10 <- multi2di(morphy)
#### contradictions/similarity index ####
dissimilarity <- sapply(treelist, function(x)
sapply(treelist, treeContradiction, tree1=x))
randomtreemean <- function(ntaxa, replicates = 100){
return(mean(unlist(mapply(treeContradiction, rmtree(replicates, ntaxa),
rmtree(replicates, ntaxa), SIMPLIFY = F))))
}
set.seed(111)
tmeanA <- randomtreemean(Ntip(treelist[[1]]))
correction <- function(dissimilarity, tmean){
return((tmean - dissimilarity)/tmean)
}
similarity <- apply(dissimilarity, c(1,2), correction, tmeanA)
colnames(similarity) <- rownames(similarity) <- c("Paup", "Morphy")
simindex <- kable(similarity)
save_kable(simindex, file = "Similarity-A2019.html")
#### RF distance ####
resolved1 <- c(paup1, morphy1)
resolved2 <- c(paup2, morphy2)
resolved3 <- c(paup3, morphy3)
resolved4 <- c(paup4, morphy4)
resolved5 <- c(paup5, morphy5)
resolved6 <- c(paup6, morphy6)
resolved7 <- c(paup7, morphy7)
resolved8 <- c(paup8, morphy8)
resolved9 <- c(paup9, morphy9)
resolved10 <- c(paup10, morphy10)
rf1 <- multiRF(resolved1)
rf2 <- multiRF(resolved2)
rf3 <- multiRF(resolved3)
rf4 <- multiRF(resolved4)
rf5 <- multiRF(resolved5)
rf6 <- multiRF(resolved6)
rf7 <- multiRF(resolved7)
rf8 <- multiRF(resolved8)
rf9 <- multiRF(resolved9)
rf10 <- multiRF(resolved10)
View(rf2)
pmrf <- c(rf1[2],rf2[2],rf3[2],rf4[2],rf5[2],rf6[2],rf7[2],rf8[2],rf9[2],rf10[2])
pmrf <- mean(pmrf)
pmrf
rtree(49, rooted = F)
rmtree(10, t9, rooted = F)
rmtree(10, 49, rooted = F)
rtrees <- rmtree(10, 49, rooted = F)
rtrees2 <- rmtree(10, 49, rooted = F)
View(rtrees)
View(rtrees2)
rant1 <- rmtree(10, 49, rooted = F)
rant2 <- rmtree(10, 49, rooted = F)
rant <- rbind(rant1, rant2)
View(rant)
rant <- cbind(rant1, rant2)
View(rant)
rant <- rbind(rant1, rant2)
multiRF(rant)
multiRF(rant1)
rant <- rmtree(10, 49, rooted = F)
multiRF(rant)
pmtd1 <- treedist(paup1,morphy1)
pmtd2 <- treedist(paup2,morphy2)
pmtd3 <- treedist(paup3,morphy3)
pmtd4 <- treedist(paup4,morphy4)
pmtd5 <- treedist(paup5,morphy5)
pmtd6 <- treedist(paup6,morphy6)
pmtd7 <- treedist(paup7,morphy7)
pmtd8 <- treedist(paup8,morphy8)
pmtd9 <- treedist(paup9,morphy9)
pmtd10 <- treedist(paup10,morphy10)
pmtd <- rbind(pmtd1,pmtd2,pmtd3,pmtd4,pmtd5,pmtd6,pmtd7,pmtd8,pmtd9,pmtd10)
pmtdmean <- apply(pmtd, 2, mean)
pmspr1 <- SPR.dist(paup1,morphy1)
pmspr2 <- SPR.dist(paup2,morphy2)
pmspr3 <- SPR.dist(paup3,morphy3)
pmspr4 <- SPR.dist(paup4,morphy4)
pmspr5 <- SPR.dist(paup5,morphy5)
pmspr6 <- SPR.dist(paup6,morphy6)
pmspr7 <- SPR.dist(paup7,morphy7)
pmspr8 <- SPR.dist(paup8,morphy8)
pmspr9 <- SPR.dist(paup9,morphy9)
pmspr10 <- SPR.dist(paup10,morphy10)
pmspr <- c(pmspr1,pmspr2,pmspr3,pmspr4,pmspr5,pmspr6,pmspr7,pmspr8,pmspr9,pmspr10)
pmspr <- mean(pmspr)
pmpd1 <- path.dist(paup1,morphy1)
pmpd2 <- path.dist(paup2,morphy2)
pmpd3 <- path.dist(paup3,morphy3)
pmpd4 <- path.dist(paup4,morphy4)
pmpd5 <- path.dist(paup5,morphy5)
pmpd6 <- path.dist(paup6,morphy6)
pmpd7 <- path.dist(paup7,morphy7)
pmpd8 <- path.dist(paup8,morphy8)
pmpd9 <- path.dist(paup9,morphy9)
pmpd10 <- path.dist(paup10,morphy10)
pmpd <- c(pmpd1,pmpd2,pmpd3,pmpd4,pmpd5,pmpd6,pmpd7,pmpd8,pmpd9,pmpd10)
pmpd <- mean(pmpd)
pmtd <- apply(pmtd, 2, mean)
##### Tree comparison table
cbind(pmrf,pmtd,pmspr,pmpd)
pmrf
pmtd
pmspr
pmpd
colnames(pmtd) <- c("Symmetric distance", "Path distance")
##### Tree comparison table
rbind(pmrf,pmtd,pmspr,pmpd)
##### Tree comparison table
cbind(pmrf,pmtd,pmspr,pmpd)
pmtd
rownames(pmtd) <- c("Paup vs Morphy")
##### Tree comparison table
cbind(pmrf,pmtd,pmspr,pmpd)
t(pmtd)
pmtd <- t(pmtd)
##### Tree comparison table
cbind(pmrf,pmtd,pmspr,pmpd)
A2019 <- cbind(pmrf,pmtd,pmspr,pmpd)
rownames(A2019) <- c("Paup vs Morphy")
A2019
A2019 <- as.data.frame(A2019)
colnames(A2019) <- c("Robinson-Foulds distance", "Symmetric difference", "Path difference", "Subtree pruning and regraft", "Path distance")
A2019 <- as.data.frame(A2019)
A2019
save_kable(kable(A2019, format = "html"), file = "TreeDistanceA2019.html")
setwd("~/Documents/Imperial/Morphological Character Hierarchies/Data/Chani-Posse & Ramirez-Salamanca, 2019/")
library(ape)
library(distory)
library(phangorn)
library(phytools)
library(paleotree)
library(tibble)
library(knitr)
library(Quartet)
library(kableExtra)
# paup
paup <- read.nexus("Paup-CPRS2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphy-CPRS2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
# morphy
morphy <- read.nexus("Morphy-CPRS2019.tre")
morphy <- consensus(morphy)
# paup
paup <- read.nexus("Paup-CPRS2019.tre")
paup <- consensus(paup)
is.rooted(paup)
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
#### basic comparison ####
comparePhylo(paup, morphy)
phylo.diff(paup, morphy, type = "cladogram")
plot.phylo(paup, type = "cladogram")
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
paup1 <- multi2di(paup)
setwd("~/Documents/Imperial/Morphological Character Hierarchies/Data/Chani-Posse & Ramirez-Salamanca, 2019/")
library(ape)
library(distory)
library(phangorn)
library(phytools)
library(paleotree)
library(tibble)
library(knitr)
library(Quartet)
library(kableExtra)
# paup
paup <- read.nexus("Paup-CPRS2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphy-CPRS2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
# paup
paup <- read.nexus("Paup-CPRS2019.tre")
# morphy
morphy <- read.nexus("Morphy-CPRS2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphy-CPRS2019.tre")
morphy <- consensus(morphy)
is.rooted(morphy)
treelist <- c(paup, morphy)
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
#### basic comparison ####
comparePhylo(paup, morphy)
setwd("~/Documents/Imperial/Morphological Character Hierarchies/Data/Chani-Posse & Ramirez-Salamanca, 2019/")
library(ape)
library(distory)
library(phangorn)
library(phytools)
library(paleotree)
library(tibble)
library(knitr)
library(Quartet)
library(kableExtra)
# paup
paup <- read.nexus("Paupcontree-CPRS2019.tre")
paup <- consensus(paup)
is.rooted(paup)
# morphy
morphy <- read.nexus("Morphycontree-CPRS2019.nex")
is.rooted(morphy)
treelist <- c(paup, morphy)
##### plot trees ####
par(mar=c(0,0,0,0))
par(mfrow=c(1,1))
plot.phylo(paup, type = "cladogram")
plot.phylo(morphy, type = "cladogram")
#### basic comparison ####
comparePhylo(paup, morphy) ## tips not correctly labelled - problem somewhere in the file
phylo.diff(paup, morphy, type = "cladogram")
#### resolve trees ####
is.binary(paup)
is.binary(morphy)
paup1 <- multi2di(paup)
paup2 <- multi2di(paup)
paup3 <- multi2di(paup)
paup4 <- multi2di(paup)
paup5 <- multi2di(paup)
paup6 <- multi2di(paup)
paup7 <- multi2di(paup)
paup8 <- multi2di(paup)
paup9 <- multi2di(paup)
paup10 <- multi2di(paup)
morphy1 <- multi2di(morphy)
morphy2 <- multi2di(morphy)
morphy3 <- multi2di(morphy)
morphy4 <- multi2di(morphy)
morphy5 <- multi2di(morphy)
morphy6 <- multi2di(morphy)
morphy7 <- multi2di(morphy)
morphy8 <- multi2di(morphy)
morphy9 <- multi2di(morphy)
morphy10 <- multi2di(morphy)
dissimilarity <- sapply(treelist, function(x)
sapply(treelist, treeContradiction, tree1=x))
randomtreemean <- function(ntaxa, replicates = 100){
return(mean(unlist(mapply(treeContradiction, rmtree(replicates, ntaxa),
rmtree(replicates, ntaxa), SIMPLIFY = F))))
}
set.seed(111)
tmeanA <- randomtreemean(Ntip(treelist[[1]]))
correction <- function(dissimilarity, tmean){
return((tmean - dissimilarity)/tmean)
}
similarity <- apply(dissimilarity, c(1,2), correction, tmeanA)
colnames(similarity) <- rownames(similarity) <- c("Paup", "Morphy")
simindex <- kable(similarity)
save_kable(simindex, file = "Similarity-A2019.html")
# random trees for comparison
rant <- rmtree(10, 49, rooted = F)
multiRF(rant)
#### treedist ####
# paup vs morphy
pmtd1 <- treedist(paup1,morphy1)
pmtd2 <- treedist(paup2,morphy2)
pmtd3 <- treedist(paup3,morphy3)
pmtd4 <- treedist(paup4,morphy4)
pmtd5 <- treedist(paup5,morphy5)
pmtd6 <- treedist(paup6,morphy6)
pmtd7 <- treedist(paup7,morphy7)
pmtd8 <- treedist(paup8,morphy8)
pmtd9 <- treedist(paup9,morphy9)
pmtd10 <- treedist(paup10,morphy10)
pmtd <- rbind(pmtd1,pmtd2,pmtd3,pmtd4,pmtd5,pmtd6,pmtd7,pmtd8,pmtd9,pmtd10)
pmtd <- apply(pmtd, 2, mean)
#### SPR ####
# paup vs morphy
pmspr1 <- SPR.dist(paup1,morphy1)
pmspr2 <- SPR.dist(paup2,morphy2)
pmspr3 <- SPR.dist(paup3,morphy3)
pmspr4 <- SPR.dist(paup4,morphy4)
pmspr5 <- SPR.dist(paup5,morphy5)
pmspr6 <- SPR.dist(paup6,morphy6)
pmspr7 <- SPR.dist(paup7,morphy7)
pmspr8 <- SPR.dist(paup8,morphy8)
pmspr9 <- SPR.dist(paup9,morphy9)
pmspr10 <- SPR.dist(paup10,morphy10)
pmspr <- c(pmspr1,pmspr2,pmspr3,pmspr4,pmspr5,pmspr6,pmspr7,pmspr8,pmspr9,pmspr10)
pmspr <- mean(pmspr)
#### Save table ####
pmtd <- t(pmtd)
colnames(pmtd) <- c("Robinson-Foulds distance", "Path distance")
CPRS2019 <- cbind(pmtd,pmspr)
rownames(CPRS2019) <- c("Paup vs Morphy")
colnames(CPRS2019) <- c("Robinson-Foulds distance", "Path distance", "Subtree pruning and regrafting")
CPRS2019 <- as.data.frame(CPRS2019)
save_kable(kable(CPRS2019, format = "html"), file = "TreeDistanceCPRS2019.html")
